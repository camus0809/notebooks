# 1. C语言的起源

- 1972年，贝尔实验室的丹尼斯·里奇（Dennis Ritch）和肯·汤普逊（Ken Thompson）在开发==UNIX==时设计了C语言

- 基于B语言

# 2. 选择C语言的理由

1. 设计特性：能让用户轻松地完成自顶向下的规划、结构化编程和模块化设计。因此其编写的程序更易懂、更可靠

1. 高效性

   - 在设计上，充分地利用当前计算机的优势，相对更紧凑，运行速度很快。

   - 具有通常时汇编语言才具有的微调控制能力，可以根据具体情况微调程序以获得最大运行速度或者最有效地使用内存

1. 可移植性

   - 在一种系统中编写的C程序稍作修改或者不修改即可在其他系统上运行 *如需修改，只需简单地修改头文件即可*

1. 强大而灵活

   - 功能强大且灵活的UNIX操作系统大部分是由C语言写的
   - 其他语言（FORTRAN、Perl、Python）的编译器和解释器都是由C语言写的
   - 可以用于解决物理学和工程学的问题
   - 可用于制作电影的动画特效

1. 面向程序员，是为了满足程序员的需求而设计的

   - 可以利用C访问硬件、操作内存中的位
   - 丰富的运算符能让程序员简单地表达自己的意图
   - 有一个大型的库，用于处理程序员经常需要解决的问题
   - 没有Pascal严谨，比C++的限制更多
     - ==优势==：使用C语言来处理许多任务都非常简洁
     - ==缺点==：可能会出现一些莫名其妙的错误

# 3. C语言的应用范围

- 从20世纪80年代，C语言就已经成为小型计算机使用的主流语言，从那以后，其应用范围扩展到微型机（PC）和大型机。

- 许多软件公司都用C语言来开发==文字处理程序、电子表格、编译器和其他产品==，因此用C语言编写的程序紧凑而高效

- C程序很方便修改，而且移植到新型号的计算机没问题
- C语言的应用范围：
  - UNIX操作系统
  - 卢卡斯公司
  - 计算机语言
  - PC应用
  - 星球大战电影
  - 机器人工厂
  - 嵌入式系统
  - 计算机游戏

# 4. 计算机能做些什么

## 4.1. 计算机的组成

1. 中央处理单位（CPU）：承担大部分的运算工作
   - 工作流程：从内存中获取并执行一个指令，然后再从内存中获取并执行下一个指令
   - CPU的小工作区：由若干个**寄存器**组成，每个寄存器都可以存出一个数字
   - 一个寄存器储存下一个指令的内存地址，CPU使用该地址来获取和更新下一条指令。在获取指令后，CPU在另一个寄存器中储存该指令，并更新第一个寄存器（pc）储存下一个指令的地址
   - CPU能理解的指令集合称为指令集，大部分为==请求计算机将一个数字从一个位置移动到另一个位置==
1. 随机存取内存（RAM）：存储程序和文件的工作区
1. 永久内存存储设备（ROM）：（*过去一般指机械硬盘，现在还包括固态硬盘*）及时在关闭计算机后，也不会丢失之前存储的程序和文件
1. 外围设备（peripheral）：提供人与计算机之间的交互

> [!note]
>
> 1. 储存在计算机中的所有内容都是数字。每个字符都有一个**数字码**，计算机存入寄存器的指令也是以数字形式储存
> 1. 计算机程序最终必须以数字指令码即**机器语言**来表示

## 4.2. 计算机工作原理

如果希望计算机做什么，则必须为其提供特殊的指令列表，明确地告诉计算机要做的事以及如何做

诸如将两数相加，则分为以下几步

- 从内存中把第一个数字拷贝到寄存器1中
- 从内存中把第二个数字拷贝到寄存器2中
- 把寄存器2中的内容与寄存器1中的内容相加，写入寄存器1
- 把寄存器1中的内容拷贝到内存中

# 5. 高级计算机语言和编译器

[高级计算机语言](https://zh.wikipedia.org/wiki/高级语言)：高度封装了的[编程语言](https://zh.wikipedia.org/wiki/编程语言)，与[低级语言](https://zh.wikipedia.org/wiki/低级语言)相对。它是以人类的日常语言为基础的一种编程语言，使用一般人易于接受的文字来表示，有较高的可读性，以方便对电脑认知较浅的人亦可以大概明白其内容

[编译器](https://zh.wikipedia.org/wiki/编译器)：把**高级语言**程序翻译成计算机能看懂的机器语言指令集的程序

- 编译器优势：一般而言，不同CPU制造商使用的指令系统和编码格式不同。但可以找到==合适的编译器或编译器集==，便可以把一种高级语言程序转换成供各种不同类型CPU使用的机器语言程序
- 高级语言以**更抽象的方式**描述行为，不受限于特定CPU或指令集。高级语言简单易学，用高级语言编程比用机器语言容易得多

> [!note]
>
> 1964年，世界上首台超级计算机 CDC6600问世，由==控制数据公司==研制

# 6. 语言标准

1987年，布莱恩·柯林汉（Brain Kernighan）和丹尼斯·里奇（Dennis Ritchie）合著的`The C Programming Language`第一版是公认的C标准，通常称为`K&R C`或经典C

## 6.1. 第一个ANSI/ISO C标准

由于ANSI先公布C标准，因此业内人士通常使用ANSI C（1989）  ISO C （1990）

指导原则为：

- 信任程序员
- 不要妨碍程序员需要做的事
- 保持语言精炼简单
- 只提供一种方法执行一项操作
- 让程序更快，及时不能保证其可移植性

## 6.2. C99标准

1994年，ANSI/ISO发布C99标准

主要修订目标：

- 支持国际化编程
- 调整现有实践致力于解决明显的缺陷
- 为适应科学和工程项目中的关键数值计算，提供C的适应性。让C比FORTRAN更有竞争力

## 6.3. C11标准

<!-- 暂且搁置 -->

# 7. 使用C语言的七步骤

C是编译型语言[^1]

## 7.1 定义程序的目标

- 想清楚需要程序去做什么

- 思考程序需要什么信息

- 要进行哪些计算和控制

- 程序需要报告什么信息

**不涉及具体的计算机语言，使用一般术语来描述问题**

## 7.2 设计程序

- 用户界面应是什么样的
- 如何组织程序
- 目标用户是谁
- 花多少时间来完成这个程序
- 在程序中如何表示数据
- 用什么方法处理数据

## 7.3 编写代码

**应给自己编写的程序添加文字注释**

## 7.4 编译

==编译的细节取决于编程环境==

编译器将源代码转换为可执行代码[^2]，这种语言由数字码表示的指令组成。

C编译器负责把C代码翻译成特定的机器语言；还将源代码与C库（**诸如scanf()、printf()等）中的代码合并成最终的程序；还会检查C语言程序是否有效

> [!note]
>
> 准确来说，是由一个被称为**链接器**的程序来链接库函数，但大多数系统中，编译器运行链接器

## 7.5 运行程序

可执行文件是可运行的程序，在常见的环境中运行程序要输入可执行文件的文件名，在一些集成开发环境（IDE integrated development environment）中可以通过选择菜单中的选项或按下特殊的按键来编辑或执行C程序

## 7.6 测试和调试程序

程序的错误称为**bug**，查找并修复程序错误的过程称为**调试**

## 7.7 维护和修改代码

发现程序有错误或者需要拓展程序的用途时则需要修改程序

# 8. 编程机制

1. 不同编译器生成程序的具体过程因计算机环境而异。用C语言编写程序时，编写的内容被存储在**文本文件**中，该文件被称为==源文件==。

2. 大部分C系统都要求文件名以`.c`结尾，在文件名中，点号前面的部分称为**基本名**（basename)，点号后面的部分称为**拓展名**(extension)。基本名和拓展名的组合即为文件名。其中文件名应当满足特定计算机操作系统的特殊要求
   - MS-DOS要求基本名不能超过8个字符
   - 有的UNIX系统限制整个文件名不超过14个字符
   - 有的UNIX系统则允许使用更长的文件名，最多255个字符
   - Linux、Windows、Macintosh OS都允许使用长文件名

## 8.1 目标代码文件、可执行文件和库

C语言基本策略：用程序把源代码文件转换为可执行文件（包含机器语言代码）典型的C实现通过**编译和链接**两步实现这个过程。

- 编译器把源代码转换为中间代码
- 链接器把中间代码和其他代码合并，生成可执行文件

​	C语言使用这种**分而治之**的方法方便对程序进行模块化，可独立编译单独的模块，稍后再用链接器合并已编译的模块。通过这种方式，如果只更改某个模块，则无须在编译别的模块，链接器还将编写的程序与编译的库代码合并

​	其中中间文件有很多种形式。其中最普遍的即为==把源文件转换为机器语言代码，并把结果放在目标代码文件中==。虽然目标文件中包含机器语言代码，但是并不能直接运行，因为目标文件中储存的是编译器翻译的源代码，还缺少==启动代码（startup code）和库函数==

​	启动代码充当着程序与操作系统之间的接口。由于几乎所有的C程序都需要使用C标准库中的函数，例如`printf()`，但用户编写编译器编译后的的目标文件中并不包含这个函数的代码，它只是使用了`print()`这个函数的指令。`printf()`真正的代码存储在另一个被称为库的文件中，库文件中有许多函数的目标代码

​	链接器的作用即是把编写的代码、系统的标准启动代码和库代码这三个部分合并为一个文件，即可执行文件。对于库代码，链接器只会把程序中要用到的库函数代码（==动态库==）提取出来

![ba5bb83c79951b623bf6acf44ab742e9](https://raw.githubusercontent.com/camus0809/Typora_Image/devl/image_2025/1029/ba5bb83c79951b623bf6acf44ab742e9.jpeg)

> [!note]
>
> 目标文件和可执行文件都是由机器语言指令组成的。但目标文件只包含编译器将编写的代码翻译的机器语言代码，可执行文件还包括编写代码中使用的库函数和启动代码的机器代码

## 8.2 UNIX系统

1. 在UNIX上编辑

   UNIX C没有自己的编辑器，故使用通用的UNIX编辑器(emacs、jove、vim)

   其中UNIX区分大小写，`budget.c`、`BUDGET.c`是不同的C源文件

1. 在UNIX上编译

   UNIX C编译器需要调用语言定义的`cc`命令，可执行文件扩展名为`.out`

   而在生成可执行文件的过程中，C编译器会创建一个余元代码基本名相同的目标代码文件，但是扩展名为`.o`。如果原始程序中由多个源代码文件，则保留目标代码文件

## 8.3 GNU编译器集合和LLVM项目

​	GNU(GUN's Not UNIX)项目始于1987年，是一个开发大量免费UNIX软件的集合。GUN编译器集合（又称GCC，其中包含GCC C编译器）是该项目的产品之一。使用`gcc`命令即可调用GCC C编译器

​	LLVM项目是与编译器相关的开源软件集合，始于伊利诺伊大学，他的Clang编译器处理C代码，可通过`clang`命令调用

## 8.4 Linux系统

Linux是一个开源、流行、类UNIX的操作系统，可在不同平台运行



[^1]: [以编译器现将代码编译为机器语言，再加以执行](https://zh.wikipedia.org/wiki/编译型语言)
[^2]: 用计算机的机器语言表示的代码